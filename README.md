<div align="center">

# RSyncer GitHub Action

[![Action on GH marketplace][marketplace badge]][marketplace] &nbsp;
[![GitHub release][release badge]][latest release] &nbsp;
[![GitHub][LICENSE badge]][LICENSE]

This action uses [rsync](https://linux.die.net/man/1/rsync "Rsync's Homepage") to sync files (probably) generated by a previous step in the workflow with a remote server.

</div>

## Secrets

### `DEPLOY_KEY`

**Required** SSH Key to be used during the rsync operation.

## Inputs

### `flags`

**Required** Flags to pass to rsync. Default `-avzr --delete`.

### `options`

**Required** Rsync options. i.e. `--exclude`.

### `ssh_options`

**Required** SSH command options. i.e. `-p 2222`.

### `src`

**Required** Local path to be synced. i.e. `public/`.

### `dest`

**Required** Remote server and path. i.e `user@server.com:/var/www/server.com/`.

## Outputs

### `status`

Friendly status of the rsync command.

## Usage

### Sync local folder to remote server

This example syncs the local folder *public* with the */var/www/server.com* folder on the remote server *server.com*.

Add the a workflow file in your repository: `.github/workflows/rsync.yml`.

```yml
- name: Deploy to server
  id: deploy
  uses: Pendect/action-rsyncer@v1.1.0
  env:
    DEPLOY_KEY: ${{secrets.DEPLOY_KEY}}
  with:
    flags: '-avzr --delete'
    options: ''
    ssh_options: ''
    src: 'public/'
    dest: 'user@server.com:/var/www/server.com'

- name: Display status from deploy
  run: echo "${{ steps.deploy.outputs.status }}"
```


### Use distinct port on remote server

This example deals with a server listening to ssh on a port other than 22.

Using a rsync workflow file: `.github/workflows/rsync.yml`, we modify the *ssh_options* input to have the *-p 2222* option:

```yml
- name: Deploy to server
  id: deploy
  uses: Pendect/action-rsyncer@v1.1.0
  env:
    DEPLOY_KEY: ${{secrets.DEPLOY_KEY}}
  with:
    flags: '-avzr --delete'
    options: ''
    ssh_options: '-p 2222'
    src: 'public/'
    dest: 'user@server.com:/var/www/server.com'

- name: Display status from deploy
  run: echo "${{ steps.deploy.outputs.status }}"
```


## Changes

### v1.1.0 (2019-12-05)

* Add support to distinct remote port [ericof]

### v1.0 (2019-11-1)

* Initial release of Pendect/action-rsyncer [ericof]


## About

[Pendect](https://pendect.com/ "Pendect's Homepage") is reshaping the way you navigate your daily flood of news.

Stay up to date with news events across the globe and be a part in the fight against fake news.

### Follow us

[![pendecthq on twitter][twitter badge]][twitter]

[twitter badge]: https://img.shields.io/twitter/follow/pendecthq.svg?style=social
[twitter]: https://twitter.com/intent/follow?screen_name=pendecthq
[marketplace badge]: https://img.shields.io/badge/GitHub-Marketplace-lightblue.svg
[marketplace]: https://github.com/marketplace/actions/rsyncer-action
[LICENSE badge]: https://img.shields.io/github/license/Pendect/action-rsyncer.svg
[LICENSE]: https://github.com/Pendect/action-rsyncer/blob/master/LICENSE
[release badge]: https://img.shields.io/github/release/Pendect/action-rsyncer.svg
[latest release]: https://github.com/Pendect/action-rsyncer/releases/latest
[star badge]: https://img.shields.io/github/stars/Pendect/action-rsyncer.svg?style=social
[star]: https://github.com/Pendect/action-rsyncer
[gh profile]: https://github.com/Pendect
